"use strict";const loadingEl=document.querySelector(".loading"),viewportEl=document.querySelector(".viewport"),containerEl=viewportEl.querySelector(".container"),contentEl=containerEl.querySelector(".markdown-html"),menuEl=document.querySelector(".menu"),isTouchDevice="ontouchstart"in document.documentElement,pageAudio=new Audio("/src/assets/audio/page.mp3");function disableScroll(){document.body.style.overflow="hidden"}function enableScroll(){document.body.style.overflow=""}async function endLoading(delay=0){await new Promise(resolve=>{setTimeout(()=>{loadingEl.classList.add("animated"),loadingEl.onanimationend=()=>loadingEl.remove(),resolve()},1e3*delay)})}async function renderPage(){let currentUrl=window.location.href;const path=window.location.pathname,paramsObj=getParamsByUrl(currentUrl);if(paramsObj.repo)return await renderGithubPage(paramsObj);if(paramsObj.md)return await renderMarkdownPage(path,paramsObj);const lastCharacterOfCurrentUrl=currentUrl.split("").reverse().join("")[0];"/"!==lastCharacterOfCurrentUrl&&(currentUrl+="/");const splitPathArray=path.split("/"),currentFolder=splitPathArray[splitPathArray.length-2];await renderMarkdownPage(path,{md:currentFolder,highlight:"about"===currentFolder?"false":"true"})}async function renderGithubPage(paramsObj){let{repo:repo,author:author,branch:branch,path:path,md:md,align:align}=paramsObj;author=author||"rayc2045",branch=branch||"master",path=path||"",md=md||"README",align=align||"justify";const markdownFile=`https://raw.githubusercontent.com/${author}/${repo}/${branch}${path}/${md}.md`;await renderContent(markdownFile,align);const title=contentEl.querySelector("h1").textContent;updateSiteTitle(title),appendGithubLink(title,author,repo)}async function renderMarkdownPage(path,paramsObj){let{md:md,align:align,highlight:highlight}=paramsObj;if(md&&(md=md.replaceAll("/","")),align=align||"justify",highlight=highlight||"true",await renderContent(`${path}${md}.md`,align,highlight),"about"===md)return;const title=contentEl.querySelector("h1").textContent;updateSiteTitle(title)}async function renderContent(markdownFile,align="justify",highlight="true"){const markdownText=await getMarkdownText(markdownFile);if(!markdownText)return redirectToNotFound();const markdownit=window.markdownit();contentEl.innerHTML=markdownit.render(markdownText).replaceAll("&lt;!-- ",'<div style="display:none;"').replaceAll(" --&gt;","</div>").replaceAll("[ ]",'<span class="checkbox">☐</span>').replaceAll("[x]",'<span class="checkbox check">☑︎</span>')+contentEl.innerHTML,"true"===highlight&&hljs.highlightAll(),contentEl.querySelectorAll("p").forEach(p=>p.classList.add(align)),contentEl.querySelectorAll("a").forEach(a=>{a.target="_blank",a.rel="noreferrer noopener"}),contentEl.querySelectorAll("img").forEach(img=>{const{s:s,width:width,align:align,c:c}=getParamsByUrl(img.src),magnification=1.5;s&&(img.src=img.src.replace(`s=${s}`,`s=${1.5*s}`)),width&&(img.style.width=1.5*width+"px"),align&&(img.closest("p").className=align),c&&img.classList.add(c)})}function getParamsByUrl(url=window.location.href){const urlSearch=url.split("?")[1],urlSearchParams=new URLSearchParams(urlSearch);return Object.fromEntries(urlSearchParams.entries())}async function getMarkdownText(markdownFile){const res=await fetch(markdownFile);return res.ok?await res.text():""}function redirectToNotFound(){window.location="/404"}function updateSiteTitle(headerText){headerText&&(document.title=headerText)}function appendGithubLink(headerText,author,repo){contentEl.querySelectorAll("a").forEach(a=>{const aText=a.textContent;aText[0]+aText[1]==="> "&&headerText.includes(aText.replace("> ",""))&&(a.parentElement.innerHTML=a.parentElement.innerHTML+` / <a href="https://github.com/${author}/${repo}" target="_blank" rel="noreferrer noopener">GitHub Repo</a>`)})}function activateHoverInteraction(...els){els.forEach(el=>el.classList.add("hover-interaction"))}function appendCircle(e,element,duration=1.5){const circle=document.createElement("div");circle.classList.add("circle");const circleOffset=.25*document.body.getBoundingClientRect().width;let customCursorOffset=-.004*document.body.getBoundingClientRect().width;isTouchDevice&&(customCursorOffset=0),circle.style.left=`${e.pageX-circleOffset-customCursorOffset}px`,circle.style.top=`${e.pageY-circleOffset-customCursorOffset}px`,circle.style.animationDuration=`${duration}s`,element.appendChild(circle),circle.onanimationend=()=>circle.remove()}function showMenu(e){menuEl.classList.remove("hide");const windowWidth=window.innerWidth,windowHeight=window.innerHeight,menuWidth=menuEl.getBoundingClientRect().width,menuHeight=menuEl.getBoundingClientRect().height,offset=5;let menuPosX=`${e.clientX+5}px`,menuPosY=`${e.clientY+5}px`;e.clientX+5+menuWidth>windowWidth&&(menuPosX=`${e.clientX-5-menuWidth}px`),e.clientY+5+menuHeight>windowHeight&&(menuPosY=`${e.clientY-5-menuHeight}px`),menuEl.style.left=menuPosX,menuEl.style.top=menuPosY}function hideEl(el){el.classList.add("hide")}function playAudio(audio,volume=1){audio.currentTime=0,audio.volume=volume,audio.play()}function resizeBodyHeight(){document.body.style.height=viewportEl.scrollHeight+"px"}document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.oncontextmenu=()=>!1,disableScroll(),window.onload=async()=>{await renderPage(),isTouchDevice?await endLoading():(activateHoverInteraction(contentEl),await endLoading(.25)),enableScroll(),resizeBodyHeight()},window.onscroll=()=>hideEl(menuEl),window.onresize=()=>{hideEl(menuEl),resizeBodyHeight()},document.onmousedown=e=>{e.target.hasAttribute("href")||hideEl(menuEl)},document.onmouseup=e=>{e.target.hasAttribute("href")&&(playAudio(pageAudio),hideEl(menuEl),3===e.which&&window.open(e.target.href,"_blank"))},document.oncontextmenu=e=>{if(e.preventDefault(),e.target.hasAttribute("href"))return!1;isTouchDevice||showMenu(e)},containerEl.onmousedown=e=>{1===e.which&&appendCircle(e,containerEl)};